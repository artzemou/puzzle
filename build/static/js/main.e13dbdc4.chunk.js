(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{105:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(37),c=a.n(r),i=(a(52),a(16)),l=(a(53),a(46)),s=a(44),u=a(14),d={flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:200,height:200,padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#ffffff",outline:"none",transition:"border .24s ease-in-out"},m=function(e){var t=e.setImages,a=Object(u.f)(),r=Object(s.a)({accept:"image/*",onDrop:function(e){var n=new FormData;n.append("file",e[0]),fetch("https://spgp-api-pre.65mo.fr/api/v2/medias/upload",{method:"POST",body:n}).then((function(e){return e.json()})).then((function(e){t([{src:"https://spgp-api-pre.65mo.fr"+e.url}]),a.push("/crop")})).catch((function(e){return console.error(e)}))}}),c=r.acceptedFiles,i=r.getRootProps,m=r.getInputProps,g=(c.map((function(e){return o.a.createElement("li",{key:e.path},e.path," - ",e.size," bytes")})),Object(n.useMemo)((function(){return Object(l.a)({},d)}),[]));return o.a.createElement("section",{className:"container"},o.a.createElement("div",i({className:"dropzone",style:g}),o.a.createElement("input",m()),o.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files")))},g=a(27),h=a(21),b=a.n(h),p=function(e){var t=e.src,a=e.setImages,r=Object(u.f)(),c=Object(n.useState)(null),l=Object(i.a)(c,2),s=l[0],d=l[1],m=Object(n.useState)(0),h=Object(i.a)(m,2),p=h[0],f=h[1],v=Object(n.useState)(1),E=Object(i.a)(v,2),x=E[0],y=E[1];Object(n.useEffect)((function(){k(t,x,p)}),[t,p,x]);var k=function(e,t,a){var n=new b.a.Stage({container:"container",width:500,height:350}),o=new b.a.Layer;function r(){var e=document.querySelector("#stage-parent").offsetWidth/500;n.width(500*e),n.height(350*e),n.scale({x:e,y:e}),n.draw()}n.add(o),b.a.Image.fromURL(e||"https://spgp-api-pre.65mo.fr/api/containers/spgp/download/06c80ebb-481c-46d2-956d-5871a540cbf7.png",(function(e){console.log(e),e.offsetX(e.width()/2),e.offsetY(e.height()/2),e.scale({x:t,y:t}),e.x(n.getWidth()/2),e.y(n.getHeight()/2),e.rotate(a),o.add(e),o.batchDraw()})),r(),window.addEventListener("resize",r);n.on("wheel",(function(e){e.evt.preventDefault();var t=n.scaleX(),a=n.getPointerPosition().x/t-n.x()/t,o=n.getPointerPosition().y/t-n.y()/t,r=e.evt.deltaY<0?1.5*t:t/1.5;n.scale({x:r,y:r});var c={x:-(a-n.getPointerPosition().x/r)*r,y:-(o-n.getPointerPosition().y/r)*r};n.position(c),n.batchDraw()}));var c=0;n.on("touchmove",(function(e){e.evt.preventDefault();var t,a,o=e.evt.touches[0],r=e.evt.touches[1];if(o&&r){var i=(t={x:o.clientX,y:o.clientY},a={x:r.clientX,y:r.clientY},Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2)));c||(c=i);var l=n.scaleX()*i/c;n.scaleX(l),n.scaleY(l),n.batchDraw(),c=i}})),n.on("touchend",(function(){c=0})),n.on("dblclick",(function(e){e.evt.preventDefault();var t=n.scaleX(),a=e.evt.shiftKey?t/1.5:1.5*t,r=n.getPointerPosition().x/t-n.x()/t,c=n.getPointerPosition().y/t-n.y()/t;n.scale({x:a,y:a});var i={x:-(r-n.getPointerPosition().x/a)*a,y:-(c-n.getPointerPosition().y/a)*a};console.log(a,e.evt.shiftKey),n.position(i),o.batchDraw()})),d(n)};return o.a.createElement("div",{className:"Cropper"},o.a.createElement("div",{className:"crop-container"}),o.a.createElement("div",{id:"container"}),o.a.createElement("div",{id:"stage-parent"},o.a.createElement("div",{id:"container"}),o.a.createElement("div",{id:"apercu"})),o.a.createElement("div",{className:"Cropper-controls"},o.a.createElement("div",{className:"Cropper-btn-crop",onClick:function(){return function(){var e=s.toDataURL(),t=document.createElement("img");t.setAttribute("crossOrigin","anonymous"),t.width=500,t.src=e,document.getElementById("apercu").appendChild(t),a([{src:e}]),r.push("/gridselector")}()},variant:"contained",color:"primary"},"Recadrer"),o.a.createElement("div",null,o.a.createElement(g.a,{xmin:.1,xmax:3,xstep:.1,axis:"x",x:x,onChange:function(e){var t=e.x;y(t)}}),o.a.createElement("label",{htmlFor:"volume"},"Zoom"),o.a.createElement(g.a,{xmin:0,xmax:360,xstep:.1,axis:"x",x:p,onChange:function(e){var t=e.x;f(t)}}),o.a.createElement("label",{htmlFor:"volume"},"Rotation"))))},f=a(45),v=a(12),E=a(42),x=a.n(E),y=function(e){return document.getElementById(e)||document.createElement("div")},k=function(e){var t=e.images,a=e.thumbs,r=e.setThumbs,c=Object(n.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,n=[],o=100/(t-1),c=100/(a-1);console.log(c);var i=e[Math.floor(Math.random()*e.length)];y("actualImage").setAttribute("src",i.src);for(var l=0;l<t*a;l++){var s=o*(l%t)+"%",u=c*Math.floor(l/t)+"%";n=[].concat(Object(f.a)(n),[{id:l,src:i.src,backgroundImage:"url("+i.src+")",backgroundSize:100*t+"%"+100*a+"%",backgroundPosition:s+" "+u,width:y("sortable").offsetWidth/t+"px",backgroundRepeat:"no-repeat",height:y("sortable").offsetHeight/a+"px"}])}r(n)}),[r]);return Object(n.useEffect)((function(){t.length&&c(t);var e=y("Grid-selector");x()(e,{onDoubleClick:function(e){return!1}})}),[c,t]),console.log(a),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"Grid"},o.a.createElement("section",{id:"Grid-selector"},o.a.createElement("ul",{id:"sortable",className:"sortable"},a.map((function(e){return o.a.createElement("li",{key:e.id,style:{backgroundImage:e.backgroundImage,backgroundSize:e.backgroundSize,backgroundPosition:e.backgroundPosition,width:e.width,height:e.height,overflow:"hidden",boxShadow:"inset 0 0 1px rgba(0, 0, 0, .5)",backgroundRepeat:e.backgroundRepeat}},o.a.createElement(v.b,{onClick:function(e){e.preventDefault()},onDoubleClick:function(t){console.log("".concat(e.id," is dblcClicked"))},to:"/gridselector/".concat(e.id)}))}))))),o.a.createElement("div",{id:"actualImageBox"},o.a.createElement("button",{onClick:function(e){"none"!==document.querySelector("#sortable li").style.boxShadow?document.querySelectorAll("#sortable li").forEach((function(e){e.style.boxShadow="none"})):document.querySelectorAll("#sortable li").forEach((function(e){e.style.boxShadow="inset 0 0 1px rgba(0, 0, 0, .5)"}))}},"Disable grid")))},w=function(e){var t=e.match,a=e.thumbs,n=(e.setThumbs,t.params.id);return console.log(a),a.length?(console.log(a),o.a.createElement("ul",{id:"Thumbs-list"},o.a.createElement("li",{style:{backgroundImage:a[n].backgroundImage,backgroundSize:a[n].backgroundSize,backgroundPosition:a[n].backgroundPosition,width:150,height:150,overflow:"hidden"}},n),a.map((function(e){if(e.id!==a[n].id)return o.a.createElement("li",{key:e.id,style:{backgroundImage:e.backgroundImage,backgroundSize:e.backgroundSize,backgroundPosition:e.backgroundPosition,width:e.width,height:e.height,overflow:"hidden"}},o.a.createElement(v.b,{to:"/gridselector/".concat(e.id)}))})))):null},P=a(43),S=a.n(P);var j=function(){var e=Object(n.useState)([{src:S.a}]),t=Object(i.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)([]),l=Object(i.a)(c,2),s=l[0],d=l[1];return console.log(s),o.a.createElement("div",{className:"App"},o.a.createElement(v.a,null,o.a.createElement("nav",{id:"Nav-bar"},o.a.createElement("li",null,o.a.createElement(v.b,{to:"/upload"},"upload")),o.a.createElement("li",null,o.a.createElement(v.b,{to:"/crop"},"crop")),o.a.createElement("li",null,o.a.createElement(v.b,{to:"/gridselector"},"grid"))),o.a.createElement(u.c,null,o.a.createElement(u.a,{exact:!0,path:"/upload",render:function(){return o.a.createElement(m,{setImages:r})}}),o.a.createElement(u.a,{exact:!0,path:"/crop",render:function(){return o.a.createElement(p,{src:a[0].src,setImages:r})}}),o.a.createElement(u.a,{exact:!0,path:"/gridselector",render:function(){return o.a.createElement(k,{images:a,thumbs:s,setThumbs:d})}}),o.a.createElement(u.a,{path:"/gridselector/:id",render:function(e,t){return o.a.createElement(w,Object.assign({},e,{thumbs:s,setThumbs:d}))}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},43:function(e,t,a){e.exports=a.p+"static/media/07180db8.933db819.svg"},47:function(e,t,a){e.exports=a(105)},52:function(e,t,a){},53:function(e,t,a){}},[[47,1,2]]]);
//# sourceMappingURL=main.e13dbdc4.chunk.js.map