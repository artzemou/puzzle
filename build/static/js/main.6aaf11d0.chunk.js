(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{107:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(38),c=n.n(r),i=(n(52),n(16)),l=(n(53),n(46)),s=n(44),u=n(7),d={flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:200,height:200,padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#ffffff",outline:"none",transition:"border .24s ease-in-out"},m=function(e){var t=e.setImages,n=Object(u.f)(),r=Object(s.a)({accept:"image/*",onDrop:function(e){t([{src:URL.createObjectURL(e[0])}]),n.push("/crop")}}),c=r.acceptedFiles,i=r.getRootProps,m=r.getInputProps,h=(c.map((function(e){return o.a.createElement("li",{key:e.path},e.path," - ",e.size," bytes")})),Object(a.useMemo)((function(){return Object(l.a)({},d)}),[]));return o.a.createElement("section",{className:"container"},o.a.createElement("div",i({className:"dropzone",style:h}),o.a.createElement("input",m()),o.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files")))},h=n(27),g=n(22),b=n.n(g),f=function(e){var t=e.src,n=e.setImages,r=Object(u.f)(),c=Object(a.useState)(null),l=Object(i.a)(c,2),s=l[0],d=l[1],m=Object(a.useState)(0),g=Object(i.a)(m,2),f=g[0],p=g[1],v=Object(a.useState)(1),E=Object(i.a)(v,2),w=E[0],x=E[1];Object(a.useEffect)((function(){y(t,w,f)}),[t,f,w]);var y=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=500,r=350,c=new b.a.Stage({container:"container",width:o,height:r}),i=new b.a.Layer;function l(){var e=document.querySelector("#stage-parent").offsetWidth/o;c.width(o*e),c.height(r*e),c.scale({x:e,y:e}),c.draw()}function s(){var e=window.matchMedia||window.msMatchMedia;return!!e&&e("(pointer:coarse)").matches}c.add(i),l(),a=s(),b.a.Image.fromURL(e,(function(e){e.draggable(a),e.offsetX(e.width()/2),e.offsetY(e.height()/2),e.scale({x:t,y:t}),e.x(c.getWidth()/2),e.y(c.getHeight()/2),e.rotate(n),i.add(e),i.batchDraw()}));var u=1.5;c.on("wheel",(function(e){e.evt.preventDefault();var t=c.scaleX(),n=c.getPointerPosition().x/t-c.x()/t,a=c.getPointerPosition().y/t-c.y()/t,o=e.evt.deltaY<0?t*u:t/u;c.scale({x:o,y:o});var r={x:-(n-c.getPointerPosition().x/o)*o,y:-(a-c.getPointerPosition().y/o)*o};c.position(r),c.batchDraw()}));var m=0;function h(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}c.on("touchmove",(function(e){e.evt.preventDefault();var t=e.evt.touches[0],n=e.evt.touches[1];if(t&&n){var a=h({x:t.clientX,y:t.clientY},{x:n.clientX,y:n.clientY});m||(m=a);var o=c.scaleX()*a/m;c.scaleX(o),c.scaleY(o),c.batchDraw(),m=a}})),c.on("touchend",(function(){m=0})),c.on("dblclick",(function(e){e.evt.preventDefault();var t=c.scaleX(),n=e.evt.shiftKey?t/u:t*u,a=c.getPointerPosition().x/t-c.x()/t,o=c.getPointerPosition().y/t-c.y()/t;c.scale({x:n,y:n});var r={x:-(a-c.getPointerPosition().x/n)*n,y:-(o-c.getPointerPosition().y/n)*n};c.position(r),i.batchDraw()})),d(c)};return o.a.createElement("div",{className:"Cropper"},o.a.createElement("div",{className:"crop-container"}),o.a.createElement("div",{id:"container"}),o.a.createElement("div",{id:"stage-parent"},o.a.createElement("div",{id:"container"}),o.a.createElement("div",{id:"apercu"})),o.a.createElement("div",{className:"Cropper-controls"},o.a.createElement("button",{className:"Cropper-btn-crop",onClick:function(){return function(){var e=s.toDataURL(),t=document.createElement("img");t.setAttribute("crossOrigin","anonymous"),t.width=500,t.src=e,document.getElementById("apercu").appendChild(t),n([{src:e}]),r.push("/gridselector")}()}},"Recadrer"),o.a.createElement("div",null,o.a.createElement(h.a,{xmin:.1,xmax:3,xstep:.1,axis:"x",x:w,onChange:function(e){var t=e.x;x(t)}}),o.a.createElement("label",{htmlFor:"volume"},"Zoom"),o.a.createElement(h.a,{xmin:0,xmax:360,xstep:.1,axis:"x",x:f,onChange:function(e){var t=e.x;p(t)}}),o.a.createElement("label",{htmlFor:"volume"},"Rotation"))))},p=n(45),v=n(14),E=n(43),w=n.n(E),x=function(e){return document.getElementById(e)||document.createElement("div")},y=function(e){var t=e.images,n=e.thumbs,r=e.setThumbs,c=Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,a=[],o=100/(t-1),c=100/(n-1),i=e[Math.floor(Math.random()*e.length)];x("actualImage").setAttribute("src",i.src);for(var l=0;l<t*n;l++){var s=o*(l%t)+"%",u=c*Math.floor(l/t)+"%";a=[].concat(Object(p.a)(a),[{id:l,src:i.src,backgroundImage:"url("+i.src+")",backgroundSize:100*t+"%"+100*n+"%",backgroundPosition:s+" "+u,width:x("sortable").offsetWidth/t+"px",backgroundRepeat:"no-repeat",height:x("sortable").offsetHeight/n+"px"}])}r(a)}),[r]);return Object(a.useEffect)((function(){t.length&&c(t);var e=x("Grid-selector");w()(e,{})}),[c,t]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"Grid"},o.a.createElement("section",{id:"Grid-selector"},o.a.createElement("ul",{id:"sortable",className:"sortable"},n.map((function(e){return o.a.createElement("li",{key:e.id,style:{backgroundImage:e.backgroundImage,backgroundSize:e.backgroundSize,backgroundPosition:e.backgroundPosition,width:e.width,height:e.height,overflow:"hidden",boxShadow:"inset 0 0 1px rgba(0, 0, 0, .5)",backgroundRepeat:e.backgroundRepeat}},o.a.createElement(v.b,{onDoubleClick:function(t){console.log("".concat(e.id," is dblcClicked"))},to:"/mOsaic/".concat(e.id)}))}))))),o.a.createElement("div",{id:"actualImageBox"},o.a.createElement("button",{onClick:function(e){"none"!==document.querySelector("#sortable li").style.boxShadow?document.querySelectorAll("#sortable li").forEach((function(e){e.style.boxShadow="none"})):document.querySelectorAll("#sortable li").forEach((function(e){e.style.boxShadow="inset 0 0 1px rgba(0, 0, 0, .5)"}))}},"Disable grid")))},k=function(e){var t=e.match,n=e.thumbs,a=(e.setThumbs,t.params.id);return n.length?o.a.createElement("ul",{id:"Thumbs-list"},o.a.createElement("li",{style:{backgroundImage:n[a].backgroundImage,backgroundSize:n[a].backgroundSize,backgroundPosition:n[a].backgroundPosition,width:150,height:150,overflow:"hidden"}},a),n.map((function(e){if(e.id!==n[a].id)return o.a.createElement("li",{key:e.id,style:{backgroundImage:e.backgroundImage,backgroundSize:e.backgroundSize,backgroundPosition:e.backgroundPosition,width:e.width,height:e.height,overflow:"hidden"}},o.a.createElement(v.b,{to:"/gridselector/".concat(e.id)}))}))):null};var P=function(){var e=Object(a.useState)([{src:"/img/museum-national-d-histoire-naturelle.png"}]),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([]),l=Object(i.a)(c,2),s=l[0],d=l[1];return o.a.createElement("div",{className:"App"},o.a.createElement(v.a,null,o.a.createElement("nav",{id:"Nav-bar"},o.a.createElement("li",null,o.a.createElement("button",null,o.a.createElement(v.b,{to:"/upload"},"T\xe9lecharger une image"))),o.a.createElement("li",null,o.a.createElement("button",null,o.a.createElement(v.b,{to:"/crop"},"Recadrer l'image"))),o.a.createElement("li",null,o.a.createElement("button",null,o.a.createElement(v.b,{to:"/gridselector"},"grid")))),o.a.createElement(u.c,null,o.a.createElement(u.a,{exact:!0,path:"/upload",render:function(){return o.a.createElement(m,{setImages:r})}}),o.a.createElement(u.a,{exact:!0,path:"/crop",render:function(){return o.a.createElement(f,{src:n[0].src,setImages:r})}}),o.a.createElement(u.a,{exact:!0,path:"/gridselector",render:function(){return o.a.createElement(y,{images:n,thumbs:s,setThumbs:d})}}),o.a.createElement(u.a,{path:"/mOsaic/:id",render:function(e,t){return o.a.createElement(k,Object.assign({},e,{thumbs:s,setThumbs:d}))}}))))},S=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function O(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(o.a.createElement(P,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");S?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):O(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):O(t,e)}))}}()},47:function(e,t,n){e.exports=n(107)},52:function(e,t,n){},53:function(e,t,n){}},[[47,1,2]]]);
//# sourceMappingURL=main.6aaf11d0.chunk.js.map